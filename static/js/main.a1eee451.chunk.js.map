{"version":3,"sources":["engine/engine.worker.js","ui/img/white_pawn.svg","ui/img/black_pawn.svg","ui/img/white_knight.svg","ui/img/black_knight.svg","ui/img/white_bishop.svg","ui/img/black_bishop.svg","ui/img/white_rook.svg","ui/img/black_rook.svg","ui/img/white_queen.svg","ui/img/black_queen.svg","ui/img/white_king.svg","ui/img/black_king.svg","ui/AnimatedSpinner.js","engine/move.js","ui/Field.js","ui/Piece.js","engine/constants.js","ui/Board.js","ui/GameMenu.js","ui/PromotionPieceSelection.js","ui/Game.js","ui/App.js","index.js"],"names":["addMethods","methods","module","exports","w","Worker","name","AnimatedSpinner","styled","div","Move","piece","start","end","this","encodedMove","Math","abs","FieldDiv","props","isEven","markColor","Field","boardIndex","children","movePiece","isStart","isEnd","isPossibleTarget","isInCheck","useDrop","accept","drop","item","monitor","pieceId","dropRef","fieldMarkStyle","ref","className","whiteImages","whitePawn","whiteKnight","whiteBishop","whiteRook","whiteQueen","whiteKing","blackImages","blackPawn","blackKnight","blackBishop","blackRook","blackQueen","blackKing","pieceNames","Image","img","isFirefox","InstallTrigger","PieceImage","color","src","alt","Piece","onPickup","onDrop","useDrag","type","begin","dropResult","collect","isDragging","drag","pieceImage","BoardGrid","Board","board","isRotated","inCheck","lastMove","currentPieceMoves","handlePlayerMove","updatePossibleMoves","clearPossibleMoves","slice","map","_","idx","rotatedIndex","key","has","sign","MenuBar","MenuItem","hidden","GameButton","button","GameResult","IconRadioInput","input","IconRadioLabel","label","getGameResultIcon","winningPlayerColor","humanPlayerColor","faMedal","faRobot","faBalanceScale","IconRadioButtons","currentValue","options","onChange","value","description","icon","Fragment","id","defaultChecked","e","target","htmlFor","title","size","GameMenu","isAiThinking","firstMovePlayed","gameEnded","startNewGame","switchSides","rotateBoard","difficultyLevel","setDifficultyLevel","canUndoMove","undoMove","disabled","onClick","faPlus","faExchangeAlt","faUndo","faRetweet","faDiceOne","faDiceTwo","faDiceThree","faDiceFour","faDiceFive","faDiceSix","Overlay","row","column","PromotionPieceSelection","playerColor","onSelection","rotatedColumn","top","pieces","index","engine","engineWorkerLoader","GameArea","startPosition","Centered","Game","useState","setRotateBoard","activePlayer","setActivePlayer","setHumanPlayerColor","isAiTurn","setAiTurn","setBoard","setGameEnded","availableMoves","setAvailableMoves","Set","setCurrentPieceMoves","winningPlayer","setWinningPlayer","moveHistory","setMoveHistory","undefined","promotion","setPromotion","setInCheck","length","clearAvailableMoves","addMove","useCallback","move","updateGame","state","a","moves","whiteInCheck","blackInCheck","checkMate","useEffect","init","newGame","setPosition","gameState","canMove","some","asyncDelay","millis","Promise","resolve","setTimeout","calculateAIMove","all","calculateMove","performMove","previousMoveHistory","interimBoard","handlePromotion","possibleMoves","filter","multiBackends","backendFactories","manager","backends","b","setup","args","forEach","apply","teardown","connectDropTarget","connectDragPreview","connectDragSource","App","DndProvider","backend","HTML5Backend","TouchBackend","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a1eee451.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"init\",\"newGame\",\"calculateMove\",\"performMove\",\"setPosition\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"f98ee41fb5446f89cd70.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","module.exports = __webpack_public_path__ + \"static/media/white_pawn.41da1b5b.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_pawn.3cab4671.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_knight.35294341.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_knight.f3636380.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_bishop.36a96cf8.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_bishop.341337f4.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_rook.007b43f5.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_rook.e7f61dec.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_queen.51d538db.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_queen.87612c77.svg\";","module.exports = __webpack_public_path__ + \"static/media/white_king.9e716b1e.svg\";","module.exports = __webpack_public_path__ + \"static/media/black_king.12ae1430.svg\";","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport styled from 'styled-components/macro';\nimport React from 'react';\n\n/* Animated spinner adapted from https://loading.io/css/ */\nconst AnimatedSpinner = styled.div`\n  color: #073642;\n  display: inline-block;\n  position: relative;\n  width: 80px;\n  height: 80px;\n  \n  margin-top: 1rem;\n  margin-right: 0.5rem;\n  margin-left: 1.5rem;\n  \n  div {\n    transform-origin: 40px 40px;\n    animation: lds-spinner 1.2s linear infinite;\n  }\n  div:after {\n    content: \" \";\n    display: block;\n    position: absolute;\n    top: 3px;\n    left: 37px;\n    width: 6px;\n    height: 18px;\n    border-radius: 20%;\n    background: #073642;\n  }\n  div:nth-child(1) {\n    transform: rotate(0deg);\n    animation-delay: -1.1s;\n  }\n  div:nth-child(2) {\n    transform: rotate(30deg);\n    animation-delay: -1s;\n  }\n  div:nth-child(3) {\n    transform: rotate(60deg);\n    animation-delay: -0.9s;\n  }\n  div:nth-child(4) {\n    transform: rotate(90deg);\n    animation-delay: -0.8s;\n  }\n  div:nth-child(5) {\n    transform: rotate(120deg);\n    animation-delay: -0.7s;\n  }\n  div:nth-child(6) {\n    transform: rotate(150deg);\n    animation-delay: -0.6s;\n  }\n  div:nth-child(7) {\n    transform: rotate(180deg);\n    animation-delay: -0.5s;\n  }\n  div:nth-child(8) {\n    transform: rotate(210deg);\n    animation-delay: -0.4s;\n  }\n  div:nth-child(9) {\n    transform: rotate(240deg);\n    animation-delay: -0.3s;\n  }\n  div:nth-child(10) {\n    transform: rotate(270deg);\n    animation-delay: -0.2s;\n  }\n  div:nth-child(11) {\n    transform: rotate(300deg);\n    animation-delay: -0.1s;\n  }\n  div:nth-child(12) {\n    transform: rotate(330deg);\n    animation-delay: 0s;\n  }\n  @keyframes lds-spinner {\n    0% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n`\n\nexport default () => (\n  <AnimatedSpinner>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n    <div></div>\n  </AnimatedSpinner>\n);\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2019 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nexport class Move {\n  constructor(piece, start, end) {\n    this.start = start;\n    this.end = end;\n    this.encodedMove = Math.abs(piece) | (start << 3) | (end << 10);\n  }\n\n  static fromEncodedMove(encodedMove) {\n    const piece = encodedMove & 0x7; // Bits 0-2\n    const start = (encodedMove >> 3) & 0x7F; // Bits 3-10\n    const end = (encodedMove >> 10) & 0x7F; // Bit 10-17\n\n    return new Move(piece, start, end);\n  }\n}\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport { useDrop } from 'react-dnd';\nimport styled from 'styled-components/macro';\n\nexport const FieldDiv = styled.div`\n  position: relative;\n  background-color: ${props => props.isEven ? \"#fdf6e3\" : \"#eee8d5\"};\n  \n  &.mark:before {\n    position: absolute;\n    content: '';\n    display: block;\n    border-radius: 50%;\n  }\n  \n  // always keep board size rectangular and maximized to the smaller axis\n  @media (min-aspect-ratio: 99/100) {\n    width: 12.5vh;\n    height: 12.5vh;\n    \n    &.mark:before {\n      top: 0.7vh;\n      left: 0.7vh;\n      bottom: 0.7vh;\n      right: 0.7vh;\n    }\n    \n    &.move:before {\n      border: 0.6vh solid ${props => props.markColor};\n      box-shadow: 0 0 0.2vh ${props => props.markColor};\n    }\n    \n    &.check:before {\n      top: 6vh;\n      left: 6vh;\n      bottom: 6vh;\n      right: 6vh;\n      background-color: ${props => props.markColor};\n      box-shadow: 0 0 2.8vh 4vh ${props => props.markColor};\n    }\n  }\n  \n  @media (max-aspect-ratio: 100/99) {\n    width: 12.5vw;\n    height: 12.5vw;\n    \n    &.mark:before {\n      top: 0.7vw;\n      left: 0.7vw;\n      bottom: 0.7vw;\n      right: 0.7vw;\n    }\n    \n    &.move:before {\n      border: 0.6vw solid ${props => props.markColor};\n      box-shadow: 0 0 0.2vw ${props => props.markColor};\n    }\n    \n    &.check:before {\n      top: 6vw;\n      left: 6vw;\n      bottom: 6vw;\n      right: 6vw;\n      background-color: ${props => props.markColor};\n      box-shadow: 0 0 2.8vw 4vw ${props => props.markColor};\n    }\n  }\n  \n`;\n\nconst Field = ({\n  boardIndex,\n  children,\n  movePiece,\n  isEven,\n  isStart,\n  isEnd,\n  isPossibleTarget,\n  isInCheck\n}) => {\n  const [, dropRef] = useDrop({\n    accept: 'PIECE',\n    drop: (item, monitor) => {\n      movePiece(item.pieceId, item.boardIndex, boardIndex);\n    }\n  });\n\n  const fieldMarkStyle = isStart || isEnd || isPossibleTarget ? ' mark move'\n                       : isInCheck ? 'mark check'\n                       : '';\n\n  const markColor = isPossibleTarget ? 'rgba(169, 189, 0, 0.69)'\n                  : isStart ? '#dc322f9f'\n                  : isEnd ? '#dc322faf'\n                  : isInCheck ? '#ff322f'\n                  : 'white';\n\n  return (\n    <FieldDiv\n      ref={dropRef}\n      isEven={isEven}\n      markColor={markColor}\n      className={fieldMarkStyle}\n    >\n      {children}\n    </FieldDiv>\n  );\n};\n\nexport default Field;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport { useDrag } from 'react-dnd';\nimport styled from 'styled-components/macro';\n\nimport whitePawn from './img/white_pawn.svg';\nimport blackPawn from './img/black_pawn.svg';\nimport whiteKnight from './img/white_knight.svg';\nimport blackKnight from './img/black_knight.svg';\nimport whiteBishop from './img/white_bishop.svg';\nimport blackBishop from './img/black_bishop.svg';\nimport whiteRook from './img/white_rook.svg';\nimport blackRook from './img/black_rook.svg';\nimport whiteQueen from './img/white_queen.svg';\nimport blackQueen from './img/black_queen.svg';\nimport whiteKing from './img/white_king.svg';\nimport blackKing from './img/black_king.svg';\nimport { BLACK } from '../engine/constants';\n\nconst whiteImages = [\n  whitePawn,\n  whiteKnight,\n  whiteBishop,\n  whiteRook,\n  whiteQueen,\n  whiteKing\n];\n\nconst blackImages = [\n  blackPawn,\n  blackKnight,\n  blackBishop,\n  blackRook,\n  blackQueen,\n  blackKing\n];\n\nconst pieceNames = [ 'Pawn', 'Knight', 'Bishop', 'Rook', 'Queen', 'King' ]\n\nconst Image = styled.img`\n  display: block;\n  margin: 13%;\n  height: 74%;\n  width: 74%;\n\n  &.dragging {\n    visibility: hidden;\n  }\n  \n  // Workaround for wrong Drag'n'Drop preview image rendering in Chrome (see https://github.com/react-dnd/react-dnd/issues/832)\n  -webkit-transform: rotateZ(0deg);\n`;\n\nconst isFirefox = typeof InstallTrigger !== 'undefined';\n\nexport const PieceImage = ({color, pieceId, ...props}) => {\n  const img = color === BLACK ? blackImages[pieceId - 1] : whiteImages[pieceId - 1];\n  return <Image src={img} alt={pieceNames[pieceId - 1]} {...props} />;\n}\n\nconst Piece = ({ boardIndex, color, piece, onPickup, onDrop }) => {\n  const pieceId = Math.abs(piece);\n  const img = color === BLACK ? blackImages[pieceId - 1] : whiteImages[pieceId - 1];\n\n  const [{ isDragging }, drag] = useDrag({\n    item: {\n      type: 'PIECE',\n      pieceId,\n      boardIndex\n    },\n    begin: monitor => onPickup(boardIndex),\n    end: dropResult => onDrop(boardIndex),\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  });\n\n  const pieceImage =\n    <Image\n      ref={drag}\n      src={img}\n      className={isDragging ? 'dragging' : ''}\n    />;\n\n  // Workaround for wrong Drag'n'Drop preview image rendering in Firefox\n  return isFirefox\n    ?  <div ref={drag}>{pieceImage}</div>\n    : pieceImage;\n};\n\nexport default Piece;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nexport const BLACK = -1;\nexport const WHITE = 1;\n\nexport const P = 1; // pawn\nexport const N = 2; // knight\nexport const B = 3; // bishop\nexport const R = 4; // rook\nexport const Q = 5; // queen\nexport const K = 6; // king\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport Field from './Field';\nimport Piece from './Piece';\nimport styled from 'styled-components/macro';\nimport { BLACK, K, WHITE } from '../engine/constants';\n\nconst BoardGrid = styled.div`\n    display: grid;\n    grid-template-columns: repeat(8, 1fr);\n    grid-template-rows: repeat(8, 1fr);\n\n    @media (min-aspect-ratio: 99/100) {\n      width: 100vh;\n      height: 100vh;\n    }\n    @media (max-aspect-ratio: 100/99) {\n      width: 100vw;\n      height: 100vw;\n    }\n    \n    box-shadow: 3px 3px 3px #586e75;\n`;\n\nconst Board = ({board, isRotated, inCheck, lastMove, currentPieceMoves, handlePlayerMove, updatePossibleMoves, clearPossibleMoves}) => {\n  return (\n    <BoardGrid isRotated={isRotated}>\n      {board.slice(0, 64).map((_, idx) => {\n        const rotatedIndex = isRotated ? 63 - idx : idx;\n        const item = board[rotatedIndex];\n\n        return (\n          <Field\n            key={rotatedIndex}\n            boardIndex={rotatedIndex}\n            movePiece={handlePlayerMove}\n            isEven={(rotatedIndex + (rotatedIndex >> 3)) % 2 === 0}\n            isStart={rotatedIndex === lastMove.start}\n            isEnd={rotatedIndex === lastMove.end}\n            isPossibleTarget={currentPieceMoves.has(rotatedIndex)}\n            isInCheck={Math.abs(item) === K && Math.sign(item) === inCheck}\n          >\n            {item !== 0 && (\n              <Piece\n                boardIndex={rotatedIndex}\n                color={item < 0 ? BLACK : WHITE}\n                piece={item}\n                onPickup={updatePossibleMoves}\n                onDrop={clearPossibleMoves}\n              />\n            )}\n          </Field>\n        );\n      })}\n    </BoardGrid>\n  );\n};\n\nexport default Board;","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport styled from 'styled-components/macro';\nimport { WHITE } from '../engine/constants';\nimport AnimatedSpinner from './AnimatedSpinner';\nimport {\n  faBalanceScale,\n  faDiceFive,\n  faDiceFour,\n  faDiceOne,\n  faDiceSix,\n  faDiceThree,\n  faDiceTwo,\n  faExchangeAlt,\n  faMedal,\n  faPlus,\n  faRetweet,\n  faRobot,\n  faUndo\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nconst MenuBar = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 0.7rem;\n  margin-left: 1rem;\n  text-align: center;\n  align-items: center;\n\n  // center menubar below board, if window width is < window height\n  @media (max-aspect-ratio: 100/99) {\n    margin-left: auto;\n    margin-right: auto;\n    flex-flow: column-reverse;\n  }\n`;\n\nconst MenuItem = styled.div`\n  position: relative;\n  display: ${props => (props.hidden ? 'none' : 'flex')};\n  padding-bottom: 0.2rem;\n  flex-direction: column;\n  \n  @media (max-aspect-ratio: 100/99) {\n    flex-direction: row;\n    align-self: center;\n  }\n`;\n\nconst GameButton = styled.button`\n  background: white;\n  color: #073642;\n  border: 1px solid #073642;\n  border-radius: 0.3rem;\n  font-size: 1rem;\n  font-weight: bold;\n  padding: 0.5rem 0.3rem;\n  width: 2.5rem;\n  margin: 0.2rem;\n  box-shadow: 1px 1px 1px #073642;\n  \n  &[disabled] {\n    display: none;\n  }\n\n  & :hover {\n    background: #073642;\n    color: white;\n    cursor: pointer;\n  }\n`;\n\nconst GameResult = styled(MenuItem)`\n  margin-top: 0.3rem;\n  font-weight: bold;\n  font-size: 1.5rem;\n  color: #073642;\n  width: 100%;\n  align-items: center;\n  \n  svg {\n    margin-left: 1rem;\n    margin-right: 1rem;\n  }\n`;\n\nconst IconRadioInput = styled.input`\n  display: none;\n  \n  &:checked + label {\n    opacity: 1;\n  }\n`;\n\nconst IconRadioLabel = styled.label`\n  color: #073642;\n  margin: 0.06rem 0.2rem;\n  opacity: 0.2;\n  \n  & :hover {\n    opacity: 0.5;\n    cursor: pointer;\n  }\n`\n\nconst colorName = color => (color === WHITE ? 'White' : 'Black');\n\nconst getGameResultIcon = (winningPlayerColor, humanPlayerColor) => {\n  if (!winningPlayerColor) {\n    return faBalanceScale;\n  }\n\n  return winningPlayerColor === humanPlayerColor\n    ? faMedal\n    : faRobot;\n}\n\nconst GameMenu = ({\n  isAiThinking,\n  firstMovePlayed,\n  humanPlayerColor,\n  gameEnded,\n  winningPlayerColor,\n  startNewGame,\n  switchSides,\n  rotateBoard,\n  difficultyLevel,\n  setDifficultyLevel,\n  canUndoMove,\n  undoMove,\n}) => (\n  <MenuBar>\n    {gameEnded &&\n    <GameResult>\n      <FontAwesomeIcon icon={getGameResultIcon(winningPlayerColor, humanPlayerColor)} size=\"2x\" />\n      {winningPlayerColor ? colorName(winningPlayerColor) + ' wins!' : 'Draw!'}\n    </GameResult>\n    }\n\n    <MenuItem hidden={isAiThinking}>\n\n      <GameButton disabled={!firstMovePlayed} onClick={startNewGame}>\n        <FontAwesomeIcon icon={faPlus} title=\"Start new game\" />\n      </GameButton>\n\n      <GameButton disabled={gameEnded || firstMovePlayed} onClick={switchSides}>\n        <FontAwesomeIcon icon={faExchangeAlt} title=\"Switch sides\" />\n      </GameButton>\n\n      <GameButton disabled={!canUndoMove || gameEnded} onClick={undoMove}>\n        <FontAwesomeIcon icon={faUndo} title=\"Undo move\" />\n      </GameButton>\n\n      <GameButton disabled={gameEnded || !firstMovePlayed} onClick={rotateBoard}>\n        <FontAwesomeIcon icon={faRetweet} title=\"Rotate board\" />\n      </GameButton>\n\n    </MenuItem>\n\n    <MenuItem hidden={isAiThinking || gameEnded}>\n      <IconRadioButtons currentValue={difficultyLevel} name=\"difficulty-level\" onChange={setDifficultyLevel}\n                        options={[\n                          {value: 1, description: \"Difficulty level 1 (easy)\", icon: faDiceOne},\n                          {value: 2, description: \"Difficulty level 2\", icon: faDiceTwo},\n                          {value: 3, description: \"Difficulty level 3\", icon: faDiceThree},\n                          {value: 4, description: \"Difficulty level 4\", icon: faDiceFour},\n                          {value: 5, description: \"Difficulty level 5\", icon: faDiceFive},\n                          {value: 6, description: \"Difficulty level 6 (hard)\", icon: faDiceSix},\n                        ]} />\n    </MenuItem>\n\n    {isAiThinking && <AnimatedSpinner /> }\n\n  </MenuBar>\n);\n\nconst IconRadioButtons = ({currentValue, name, options, onChange}) => (\n  <>\n    {options.map(({value, description, icon}) => (\n      <React.Fragment key={`${name}-${value}`}>\n        <IconRadioInput type=\"radio\" id={`${name}-${value}`} name={name} value={value} defaultChecked={currentValue === value} onChange={(e) => onChange(e.target.value)} />\n        <IconRadioLabel htmlFor={`${name}-${value}`}>\n          <FontAwesomeIcon icon={icon} title={description} size=\"2x\" />\n        </IconRadioLabel>\n      </React.Fragment>\n      ))}\n  </>\n);\n\nexport default GameMenu;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2019 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport styled from 'styled-components/macro';\nimport { B, BLACK, N, Q, R, WHITE } from '../engine/constants';\nimport { PieceImage } from './Piece';\nimport React from 'react';\n\nconst Overlay = styled.div`\n  outline: 1px solid #586e75;\n  box-shadow: 3px 3px 3px #586e75;\n  margin: 0;\n  padding: 0;\n  position: absolute;\n  z-index: 1;\n  \n  @media (min-aspect-ratio: 99/100) {\n    top: ${props => props.row * 12.5}vh;\n    left: ${props => props.column * 12.5}vh;\n    width: 12.5vh;\n    height: 50vh;\n  }\n  @media (max-aspect-ratio: 100/99) {\n    top: ${props => props.row * 12.5}vw;\n    left: ${props => props.column * 12.5}vw;\n    width: 12.5vw;\n    height: 50vw;\n  }\n`;\n\nconst FieldDiv = styled.div`\n  position: absolute;\n  background-color: ${props => props.isEven ? '#fdf6e3' : '#eee8d5'};\n  \n  @media (min-aspect-ratio: 99/100) {\n    top: ${props => props.row * 12.5}vh;\n    width: 12.5vh;\n    height: 12.5vh;\n  }\n  @media (max-aspect-ratio: 100/99) {\n    top: ${props => props.row * 12.5}vw;\n    width: 12.5vw;\n    height: 12.5vw;\n  }\n`;\n\nconst PromotionPieceSelection = ({ column, playerColor, onSelection, isRotated }) => {\n  const rotatedColumn = isRotated ? 7 - column : column;\n\n  const top = playerColor === WHITE\n    ? isRotated ? 4 : 0\n    : isRotated ? 0 : 4;\n\n  let pieces = (isRotated && playerColor !== BLACK) || (!isRotated && playerColor === BLACK) ? [N, B, R, Q] : [Q, R, B, N];\n\n  return (\n    <Overlay row={top} column={rotatedColumn}>\n      {\n        pieces.map((piece, index) => (\n          <FieldDiv key={index} row={index} isEven={(rotatedColumn + index) & 1} onClick={() => onSelection(piece)}>\n            <PieceImage color={playerColor} pieceId={piece}/>\n          </FieldDiv>\n        ))\n      }\n    </Overlay>\n  );\n\n};\n\nexport default PromotionPieceSelection;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components/macro';\n\nimport engineWorkerLoader from 'workerize-loader!../engine/engine.worker'; // eslint-disable-line import/no-webpack-loader-syntax\nimport { BLACK, P, WHITE } from '../engine/constants';\nimport AnimatedSpinner from './AnimatedSpinner';\nimport { Move } from '../engine/move';\nimport Board from './Board';\nimport GameMenu from './GameMenu';\nimport PromotionPieceSelection from './PromotionPieceSelection';\n\nconst engine = engineWorkerLoader();\n\nconst GameArea = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nconst startPosition = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\n\nconst nextPlayer = playerColor => -playerColor;\n\nconst Game = () => {\n  const [rotateBoard, setRotateBoard] = useState(false);\n  const [activePlayer, setActivePlayer] = useState(WHITE);\n  const [humanPlayerColor, setHumanPlayerColor] = useState(WHITE);\n  const [isAiTurn, setAiTurn] = useState(false);\n  const [board, setBoard] = useState();\n  const [gameEnded, setGameEnded] = useState(false);\n  const [availableMoves, setAvailableMoves] = useState([]);\n  const [currentPieceMoves, setCurrentPieceMoves] = useState(new Set());\n  const [winningPlayer, setWinningPlayer] = useState();\n  const [difficultyLevel, setDifficultyLevel] = useState(6);\n  const [moveHistory, setMoveHistory] = useState([]);\n  const [promotion, setPromotion] = useState(undefined);\n  const [inCheck, setInCheck] = useState(0);\n\n  const lastMove = moveHistory.length > 0 ? moveHistory[moveHistory.length - 1] : { start: -1, end: -1 };\n\n  const clearAvailableMoves = () => setAvailableMoves([]);\n\n  const addMove = useCallback(move => {\n    setMoveHistory([...moveHistory, move])\n  }, [setMoveHistory, moveHistory]);\n\n  const updateGame = useCallback(async state => {\n    setBoard(state.board);\n    setAvailableMoves(state.moves);\n\n    if (state.whiteInCheck) {\n      setInCheck(WHITE);\n    } else if (state.blackInCheck) {\n      setInCheck(BLACK);\n    } else {\n      setInCheck(0);\n    }\n\n    if (state.gameEnded) {\n      setGameEnded(true);\n\n      if (state.checkMate) {\n        setWinningPlayer(nextPlayer(state.activePlayer));\n      }\n    } else {\n      setActivePlayer(state.activePlayer);\n    }\n\n  }, []);\n\n  // Initialize chess engine and game state\n  useEffect(() => {\n    (async () => {\n      await engine.init();\n      await engine.newGame();\n      const gameState = await engine.setPosition(startPosition, []);\n      await updateGame(gameState);\n    })();\n  }, [updateGame]);\n\n  const canMove = useCallback((start, end) => {\n    return availableMoves.some(\n      move => move.start === start && move.end === end\n    );\n  }, [availableMoves]);\n\n  const asyncDelay = (millis) => new Promise(resolve => setTimeout(resolve, millis));\n\n  const calculateAIMove = useCallback(async () => {\n    clearAvailableMoves();\n    setAiTurn(true);\n\n    const [move] = await Promise.all([engine.calculateMove(difficultyLevel), asyncDelay(150)]);\n\n    const gameState = await engine.performMove(move);\n    setAiTurn(false);\n    await updateGame(gameState);\n    addMove(move);\n  }, [difficultyLevel, addMove, updateGame]);\n\n  const switchSides = async () => {\n    setRotateBoard(true);\n    setHumanPlayerColor(-humanPlayerColor);\n    setAiTurn(true);\n  };\n\n  // Calculate next AI move whenever isAiTurn is set to true\n  useEffect( () => {\n    if (isAiTurn) {\n      (async () => {\n        await calculateAIMove();\n      })();\n    }\n  }, [isAiTurn, calculateAIMove]);\n\n  const startNewGame = async () => {\n    setGameEnded(false);\n    setWinningPlayer(undefined);\n    setActivePlayer(WHITE);\n    setHumanPlayerColor(WHITE);\n    setMoveHistory([]);\n    setCurrentPieceMoves(new Set());\n\n    await engine.newGame();\n    const gameState = await engine.setPosition(startPosition, []);\n    await updateGame(gameState);\n\n    setRotateBoard(false);\n  };\n\n  const undoMove = useCallback(async () => {\n    const previousMoveHistory = moveHistory.slice(0, moveHistory.length - 2);\n    const gameState = await engine.setPosition(startPosition, previousMoveHistory);\n    setMoveHistory(previousMoveHistory);\n    await updateGame(gameState);\n  }, [moveHistory, setMoveHistory, updateGame]);\n\n  const handlePlayerMove = useCallback(async (piece, start, end) => {\n    let pieceId = Math.abs(piece);\n    if (gameEnded || isAiTurn) {\n      return;\n    }\n\n    if (!canMove(start, end)) {\n      return;\n    }\n\n    setCurrentPieceMoves(new Set());\n\n    if (pieceId === P && ((activePlayer === WHITE && end < 8) || (activePlayer === BLACK && end >= 56))) {\n      // Promotion\n\n      clearAvailableMoves();\n      setPromotion({\n        start: start,\n        end: end,\n        column: end & 7,\n        color: activePlayer\n      });\n    } else {\n\n      // Standard move\n      const interimBoard = board.slice();\n      interimBoard[start] = 0;\n      setBoard(interimBoard);\n\n      const move = new Move(pieceId, start, end);\n      const gameState = await engine.performMove(move);\n      await updateGame(gameState);\n      addMove(move);\n\n      if (!gameState.gameEnded) {\n        setAiTurn(true);\n      }\n    }\n\n  }, [activePlayer, addMove, board, canMove, gameEnded, isAiTurn, updateGame]);\n\n  const handlePromotion = useCallback(async (pieceId) => {\n    const { start, end } = promotion;\n    setPromotion(undefined);\n    const interimBoard = board.slice();\n    interimBoard[start] = 0;\n    setBoard(interimBoard);\n\n    const move = new Move(pieceId, start, end);\n    const gameState = await engine.performMove(move);\n    await updateGame(gameState);\n    addMove(move);\n\n    if (!gameState.gameEnded) {\n      setAiTurn(true);\n    }\n  }, [addMove, board, promotion, setPromotion, updateGame]);\n\n  const updatePossibleMoves = start => {\n    const possibleMoves = availableMoves\n      .filter(move => move.start === start)\n      .map(move => move.end);\n    setCurrentPieceMoves(new Set(possibleMoves));\n  };\n\n  const clearPossibleMoves = () => {\n    setCurrentPieceMoves(new Set());\n  };\n\n  return (\n    board\n      ? (\n        <GameArea>\n          {promotion &&\n          <PromotionPieceSelection column={promotion.column} playerColor={promotion.color} isRotated={rotateBoard}\n                                   onSelection={handlePromotion}/>}\n          <Board\n            board={board}\n            isRotated={rotateBoard}\n            lastMove={lastMove}\n            currentPieceMoves={currentPieceMoves}\n            handlePlayerMove={handlePlayerMove}\n            updatePossibleMoves={updatePossibleMoves}\n            clearPossibleMoves={clearPossibleMoves}\n            inCheck={inCheck}\n          />\n          <GameMenu\n            isAiThinking={isAiTurn}\n            firstMovePlayed={lastMove.start !== -1}\n            humanPlayerColor={humanPlayerColor}\n            gameEnded={gameEnded}\n            winningPlayerColor={winningPlayer}\n            startNewGame={startNewGame}\n            switchSides={switchSides}\n            rotateBoard={() => setRotateBoard(!rotateBoard)}\n            difficultyLevel={difficultyLevel}\n            setDifficultyLevel={setDifficultyLevel}\n            canUndoMove={!gameEnded && moveHistory.length > 1}\n            undoMove={undoMove}\n          />\n        </GameArea>\n      )\n      : (\n        <Centered><AnimatedSpinner/></Centered>\n      )\n  );\n};\n\nconst Centered = styled.div`\n  position: absolute;\n  left: calc(50% - 60px);\n  top: calc(50% - 60px);\n`;\n\nexport default Game;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport Game from './Game';\nimport { DndProvider } from 'react-dnd';\nimport HTML5Backend from 'react-dnd-html5-backend';\nimport TouchBackend from 'react-dnd-touch-backend';\n\nconst multiBackends = (...backendFactories) =>\n  function(manager) {\n    const backends = backendFactories.map(b => b(manager));\n    return {\n      setup: (...args) =>\n        backends.forEach(b => b.setup.apply(b, args)),\n      teardown: (...args) =>\n        backends.forEach(b => b.teardown.apply(b, args)),\n      connectDropTarget: (...args) =>\n        backends.forEach(b => b.connectDropTarget.apply(b, args)),\n      connectDragPreview: (...args) =>\n        backends.forEach(b => b.connectDragPreview.apply(b, args)),\n      connectDragSource: (...args) =>\n        backends.forEach(b => b.connectDragSource.apply(b, args)),\n    };\n  };\n\nfunction App() {\n  return (\n    <main>\n      <DndProvider backend={multiBackends(HTML5Backend, TouchBackend)}>\n        <Game />\n      </DndProvider>\n    </main>\n  );\n}\n\nexport default App;\n","/*\n * A free and open source chess game using AssemblyScript and React\n * Copyright (C) 2020 mhonert (https://github.com/mhonert)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './ui/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}